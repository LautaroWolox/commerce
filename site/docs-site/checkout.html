<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout ‚Ä¢ E‚Äëcommerce</title>
  <meta name="description" content="Documentaci√≥n E2E de la arquitectura E-commerce." />
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="css/animations.css" />
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>if (window.mermaid) { mermaid.initialize({ startOnLoad: true, theme: 'dark' }); }</script>
</head>
<body>

  <header class="site-header" role="banner" aria-label="Cabecera">
    <a class="brand" href="README.html" aria-label="Ir a inicio">E‚ÄëCommerce E2E</a>
    
    <nav class="main-nav" role="navigation" aria-label="Navegaci√≥n principal">
      <a href="README.html">√çndice</a>
      <a href="architecture.html">Arquitectura</a>
      <a href="checkout.html">Checkout</a>
      <a href="kafka.html">Kafka</a>
      <a href="openai.html">OpenAI</a>
      <a href="deploy.html">Despliegue</a>
      <a href="observability.html">Observabilidad</a>
      <a href="databases.html">Datos</a>
      <a href="code.html">C√≥digo</a>
      <a href="deployments.html">Dev‚ÜíProd</a>
      <a href="docs.html">Docs T√©cnicos</a>
      <a href="diagrams.html">Diagramas</a>
      <a href="animations.html">Animaciones</a>
    </nav>
    <button id="themeToggle" class="btn" aria-pressed="false" aria-label="Cambiar tema">üåì</button>
  </header>
  <main id="content" tabindex="-1">

<section class="content fade-in">
  <h1>Flujo de Checkout (por etapas)</h1>
  <div class="m-actions">
    <a class="btn" href="https://mermaid.live" target="_blank" rel="noreferrer noopener">Abrir en Mermaid Live ‚Üó</a>
  </div>
  <div class="mermaid">
sequenceDiagram
  participant U as Usuario
  participant B as Browser
  participant G as API Gateway
  participant A as Auth (OIDC)
  participant O as Order Service
  participant P as Payment Service
  participant K as Kafka
  participant DB as PostgreSQL

  U->>B: Click "Comprar"
  B->>G: POST /checkout
  G->>A: Validaci√≥n OIDC
  A-->>G: Token JWT v√°lido
  G->>O: Crear orden (Bearer JWT)
  O->>K: Publicar evento "OrderCreated"
  K-->>P: Consumir evento
  P->>DB: Persistir pago
  P-->>O: Confirmaci√≥n
  O-->>B: Orden confirmada
</div>
</section>

  </main>
<footer class="site-footer">
  <small>¬© 2025 Arquitectura E-commerce ‚Ä¢ Documentaci√≥n est√°tica Lautaro Buson</small>
</footer>
  <script src="js/main.js"></script>
  <script src="js/animations.js"></script>

<script>
(function(){
  var nav=document.querySelector('.main-nav');
  if(!nav) return;
  if(nav.querySelector('a[href$="DOCUMENTACION.html"]')) return;
  var a=document.createElement('a');
  a.href=(location.pathname.includes('/docs-site/')?'../DOCUMENTACION.html':'./DOCUMENTACION.html');
  a.textContent='Documentaci√≥n';
  nav.appendChild(a);
})();
</script>

</body>
</html>